---
layout: post
title: OWASP Web Top 10 
date: 2023-05-15
icon: https://owasp.org/Top10/assets/TOP_10_logo_Final_Logo_Colour.png
categories: [Notes]
tags: [owasp,webappsec]
pin: false
image:
  path: https://owasp.org/Top10/assets/TOP_10_logo_Final_Logo_Colour.png
  width: 1280   # in pixels
  height: 720   # in pixels
  alt: 
---

# 1. Broken Access Control

## What is Broken Access Control

>Broken access control allows attackers to bypass authorization, allowing them to view sensitive data or perform tasks they aren't supposed to.<br>
Broken access control occurs when access control in an application is improperly implemented and can be bypassed by an attacker.<br>
Broken access control arise when users can act outside of their intended permissions. This typically leads to sensitive information disclosure, unauthorized access and modifications or destruction of data.
{: .prompt-info}

## Different Types of Access Control

### Horizontal Access Control -

![image](https://i.postimg.cc/rsXKm8rZ/screenshot-234.jpg){: width='1280' height='720'}

![image](https://i.postimg.cc/gj28dcb9/screenshot-235.jpg){: width='1280' height='720'}

### Vertical Access Control -

![image](https://i.postimg.cc/bwrGvV5n/screenshot-237.jpg){: width='1280' height='720'}

![image](https://i.postimg.cc/tC5RWd6z/screenshot-236.jpg){: width='1280' height='720'}

### Context-Dependent Access Control -

![image](https://i.postimg.cc/XYtvYjdM/screenshot-238.jpg){: width='1280' height='720'}

![image](https://i.postimg.cc/K8b2q1P8/screenshot-239.jpg){: width='1280' height='720'}

![image](https://i.postimg.cc/0jLwRY83/screenshot-240.jpg){: width='1280' height='720'}

### Exposed Admin Panels

- Developers sometimes overlook securing sensitive functionalities like admin panels, assuming they are inaccessible due to obscurity, but attackers can find and access them using techniques like Google dorks or URL brute-forcing.
    
    Eg: https://example.com/YWRtaW4/admin.php
    
- Inconsistent access control mechanisms can lead to vulnerabilities. For example, an admin panel may require authentication for external requests but not for internal requests, leaving it vulnerable to exploitation through SSRF attacks.
- Predictable cookies or request headers can be manipulated by attackers to bypass access control. For instance, if the admin panel relies on a specific cookie value like `admin=1`, an attacker can include the same cookie in their requests to gain unauthorized access.
- Users can bypass access control points and directly access the admin panel by browsing to specific URLs.
    

   > Example
    Let’s say the usual way of accessing `example.com’s` admin panel is
    via the URL https://example.com/YWRtaW4/admin.php. If you browse to that
    URL, you’ll be prompted to log in with your credentials. After that, you’ll
    be redirected to `https://example.com/YWRtaW4/dashboard.php`, which is where
    the admin panel resides.
    {: .prompt-info}
    
- Lack of access control implementation at the dashboard page allows users to access the admin panel without credentials

### Directory Traversal Vulnerabilities

- Directory traversal vulnerabilities allow attackers to manipulate filepaths and gain unauthorized access to files.
- Attackers can use "../" sequences to escape out of restricted folders and access sensitive files.
- For example, a request like **http://example.com/upload?file=../../../../../etc/shadow** can access the /etc/shadow file containing hashed passwords.
- Attackers can crack passwords from the /etc/shadow file to gain access to privileged user accounts.
- Additionally, sensitive files such as configuration files, log files, and source code may also be accessed by exploiting directory traversal vulnerabilities.

## Hunting for Application Logic Errors and Broken Access Control

- Application logic errors and broken access control are easy bugs for beginners to find.
- Hunting for these vulnerabilities requires creative thinking and experimentation, not code tampering or malicious inputs.
- `Step 1:` Learn about the target application by browsing it as a regular user and reading its engineering blogs and documentation.
    - Example: Test newly added payment options or try accessing the default path for WordPress admin portals `(/wp-admin/admin.php)`.
- `Step 2:` Intercept requests while browsing and pay attention to sensitive functionalities.
    - Take note of how access control is implemented and how it interacts with client requests.
    - Example: Identify the requests needed to complete a payment and check if any parameters indicate payment type or amount.
- `Step 3:` Think outside the box and find ways to bypass access control or interfere with application logic.
    - Play with intercepted requests and craft requests that should not be granted.
    - Example: Modify the amount parameter to charge a lower amount or switch the payment type to a gift card without having one.
    - Example: Access the admin page by adding a special cookie, such as `admin=1.`

## Escalating the Attack

- Escalating the attack involves leveraging application logic errors and broken access control vulnerabilities.
- Combining these vulnerabilities with other weaknesses can amplify their impact.
- A broken access control vulnerability can provide unauthorized access to the admin panel, allowing for actions like console or application deployment.
- This unauthorized access may lead to remote code execution.
- By locating configuration files of a web application, an attacker can identify Common Vulnerabilities and Exposures (CVEs) specific to the software versions in use, facilitating further exploitation.
- Credentials found in a file may enable access to other machines on the network.
- The potential impact of application logic errors and broken access control vulnerabilities may not be immediately evident.
- While the impact of a vulnerability like SQL injection or stored XSS is often clear, it isn’t always apparent what attackers can achieve with application logic errors and broken access control vulnerabilities
- It is important to consider how malicious users could exploit these vulnerabilities to their fullest extent.
- Detailed communication of the impact in a report is necessary to highlight the severity and implications of these vulnerabilities.

## Prevention

- Perform thorough testing to verify the application's logic, considering both business requirements and development process.
- Review each process for logical flaws that may pose security risks.
- Implement granular access control policies on all files and actions, and audit the code for potential bypasses.
- Conduct penetration testing to identify access control vulnerabilities.
- Ensure consistent access control mechanisms across different access points, such as mobile devices, desktop devices, and API endpoints, with the same authentication requirements (e.g., MFA) for each.

## Impact of Access Control Vulnerability

- It affects CIA triad
- Can sometimes be chained with other vulnerabilities to gain RCE on the host OS